function Orient(e){var o=this;this.init=function(e){this.flowURL=e.flowURL,this.flowData=[],this.activeSlideIndex=0,this.autoScroll=!1!==e.autoScroll,this.cssPrefix=e.cssPrefix,this.buttonHtml=e.buttonHtml||{},this.clickOverlayClosesTour=e.clickOverlayClosesTour||!1,this.overlay=!1!==e.overlay,e.keyEvents&&document.addEventListener("keydown",this.handleKeyDown),window.addEventListener("resize",this.positionSlide)},this.loadFlow=function(t){this.httpGet(this.flowURL,function(e){o.flowLoaded(e),t()},this.flowError)},this.setFlowURL=function(e){this.stopFlow(),this.flowURL=e},this.nextSlide=function(){document.body.removeChild(o.activeSlideEl),o.removeAttachedTargetStyles(),o.flowData[o.activeSlideIndex].onEnd&&new Function(o.flowData[o.activeSlideIndex].onEnd)(),o.activeSlideIndex++,o.activeSlideIndex>o.flowData.length-1?(o.activeSlideEl=null,o.stopFlow()):(o.activeSlideEl=o.buildSlide(),o.insertSlide())},this.prevSlide=function(){o.flowData[o.activeSlideIndex].onEnd&&new Function(o.flowData[o.activeSlideIndex].onEnd)();0<o.activeSlideIndex&&(document.body.removeChild(o.activeSlideEl),o.removeAttachedTargetStyles(),o.activeSlideIndex--,o.activeSlideEl=o.buildSlide(),o.insertSlide())},this.jumpToSlide=function(e){e<1||e>o.flowData.length||(document.body.removeChild(o.activeSlideEl),o.activeSlideIndex=e-1,o.activeSlideEl=o.buildSlide(),o.insertSlide())},this.startFlow=function(){this.activeSlideIndex=0,this.activeSlideEl=this.buildSlide(),this.insertSlide()},this.stopFlow=function(){o.activeSlideEl&&(document.body.removeChild(o.activeSlideEl),o.removeAttachedTargetStyles()),o.activeSlideEl=o.activeSlideIndex=null,document.removeEventListener("keydown",o.handleKeyDown)},this.insertSlide=function(){document.body.appendChild(this.activeSlideEl)},this.buildSlide=function(){var e=this.flowData[this.activeSlideIndex];if(this.slideEl=this.createElement({type:"div",className:"animated fadeInDown orient-slide orient-slide--"+e.style}),e.extraClasses&&Array.isArray(e.extraClasses)&&0<e.extraClasses.length)for(var t=0;t<e.extraClasses.length;t++)this.slideEl.className+=" "+e.extraClasses[t];if("float"===e.style&&(this.attachTargetEl=null,this.positionSlide()),e.media&&"object"==typeof e.media){var i,l=this.createElement({type:"div",className:"orient-slide__media"});"video"===e.media.type?((i=document.createElement("video")).muted=void 0===e.media.muted||e.media.muted,i.loop=void 0===e.media.loop||e.media.loop,i.controls=void 0!==e.media.controls&&e.media.controls,i.autoplay=void 0===e.media.autoplay||e.media.autoplay):"image"===e.media.type&&(i=document.createElement("img")),e.media.url&&(i.src=e.media.url),l.appendChild(i),this.slideEl.appendChild(l)}var a=this.createElement({type:"div",className:"orient-slide__text-wrapper"});a.appendChild(this.createElement({type:"div",className:"orient-slide__title",text:e.title})),a.appendChild(this.createElement({type:"div",className:"orient-slide__body",text:e.body}));var n=this.createElement({type:"div",className:"orient-slide__button-wrapper"});n.appendChild(this.createElement({type:"div",className:"orient-slide__button orient-slide__close-button",html:this.buttonHtml.exit||"Exit",events:{click:orient.stopFlow}})),0<this.activeSlideIndex&&n.appendChild(this.createElement({type:"div",className:"orient-slide__button orient-slide__prev-button",html:this.buttonHtml.prev||"Prev",events:{click:orient.prevSlide}})),this.activeSlideIndex<this.flowData.length-1&&n.appendChild(this.createElement({type:"div",className:"orient-slide__button orient-slide__next-button",html:this.buttonHtml.next||"Next",events:{click:orient.nextSlide}}));var s=this.createElement({type:"div",className:"orient-slide__content"});s.appendChild(a),s.appendChild(n),this.slideEl.appendChild(s),e.onShow&&this.slideEl.appendChild(this.createElement({type:"script",html:e.onShow}));var d=this.createElement({type:"div",className:(o.cssPrefix?o.cssPrefix:"")+" orient-slide-wrapper"});return this.overlay&&d.appendChild(this.createElement({type:"div",className:"orient-slide__overlay",events:{click:o.clickOverlayClosesTour?orient.stopFlow:null}})),d.appendChild(this.slideEl),d},this.createElement=function(e){var t=document.createElement(e.type);if(e.className&&(t.className=e.className),e.text?t.innerText=e.text:e.html&&(t.innerHTML=e.html),e.events&&"object"==typeof e.events)for(var i in e.events)t.addEventListener(i,e.events[i]);return t},this.handleKeyDown=function(e){switch(e.keyCode){case 39:return void o.nextSlide();case 37:return void o.prevSlide();case 27:return void o.stopFlow();default:return}},this.httpGet=function(e,t,i){var l=new XMLHttpRequest;l.addEventListener("load",t),l.addEventListener("error",i),l.open("GET",e),l.send()},this.flowLoaded=function(e){if(4===e.target.readyState&&200===e.target.status)try{this.flowData=JSON.parse(e.target.responseText)}catch(e){}},this.flowError=function(){},this.positionSlide=function(){var e=o.flowData[o.activeSlideIndex].target;if(e)if("#"===e.substr(0,1)||"."===e.substr(0,1)?o.attachTargetEl=document.querySelector(e):o.attachTargetEl=document.querySelector("[data-orient-target='"+e+"']"),o.attachTargetEl){o.attachTargetEl.classList.add("orient-target-el");var t=o.getElAbsolutePosition(o.attachTargetEl);if(t.left+360>window.innerWidth?(o.slideEl.classList.add("orient-slide--aligned-right"),o.slideEl.style.right=window.innerWidth-t.right+"px"):o.slideEl.style.left=t.left+"px",o.slideEl.style.top=t.top+t.height+"px",o.autoScroll){var i=t.top+t.height-window.innerHeight/2;i=i<0?0:i,window.scrollTo(0,i)}}else o.slideEl.style.top="0px",o.slideEl.style.left="0px"},this.removeAttachedTargetStyles=function(){this.attachTargetEl&&(this.attachTargetEl.removeAttribute("style"),o.attachTargetEl.classList.remove("orient-target-el"))},this.getElAbsolutePosition=function(e){var t,i,l=e.getBoundingClientRect();return i=window.scrollX&&window.scrollY?(t=window.scrollX,window.scrollY):(t=window.pageXOffset,window.pageYOffset),{left:l.left+t,right:l.right+t,top:l.top+i,bottom:l.bottom+i,height:l.height,width:l.width}},this.init(e)}